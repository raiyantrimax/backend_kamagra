{
  "info": {
    "name": "Contact Form API",
    "description": "Complete API collection for contact form management system",
    "schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json"
  },
  "item": [
    {
      "name": "Public Endpoints",
      "item": [
        {
          "name": "Submit Contact Form",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test(\"Status code is 201\", function () {",
                  "    pm.response.to.have.status(201);",
                  "});",
                  "",
                  "pm.test(\"Response has success property\", function () {",
                  "    var jsonData = pm.response.json();",
                  "    pm.expect(jsonData).to.have.property('success');",
                  "    pm.expect(jsonData.success).to.be.true;",
                  "});",
                  "",
                  "pm.test(\"Response has contact data\", function () {",
                  "    var jsonData = pm.response.json();",
                  "    pm.expect(jsonData).to.have.property('contact');",
                  "    pm.expect(jsonData.contact).to.have.property('id');",
                  "});",
                  "",
                  "// Save contact ID for later use",
                  "if (pm.response.code === 201) {",
                  "    var jsonData = pm.response.json();",
                  "    pm.environment.set('contact_id', jsonData.contact.id);",
                  "}"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json",
                "type": "text"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"name\": \"John Doe\",\n  \"email\": \"john.doe@example.com\",\n  \"phone\": \"1234567890\",\n  \"subject\": \"Product Inquiry\",\n  \"message\": \"I would like to know more about your products and pricing. Please provide detailed information.\"\n}"
            },
            "url": {
              "raw": "{{base_url}}/api/contact",
              "host": ["{{base_url}}"],
              "path": ["api", "contact"]
            },
            "description": "Submit a new contact form. This endpoint is public and does not require authentication."
          },
          "response": []
        },
        {
          "name": "Submit Contact - Missing Fields",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test(\"Status code is 400\", function () {",
                  "    pm.response.to.have.status(400);",
                  "});",
                  "",
                  "pm.test(\"Response has error message\", function () {",
                  "    var jsonData = pm.response.json();",
                  "    pm.expect(jsonData.success).to.be.false;",
                  "    pm.expect(jsonData.message).to.include('required');",
                  "});"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json",
                "type": "text"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"name\": \"John Doe\",\n  \"email\": \"john.doe@example.com\"\n}"
            },
            "url": {
              "raw": "{{base_url}}/api/contact",
              "host": ["{{base_url}}"],
              "path": ["api", "contact"]
            },
            "description": "Test validation - missing required message field."
          },
          "response": []
        },
        {
          "name": "Submit Contact - Invalid Email",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test(\"Status code is 400\", function () {",
                  "    pm.response.to.have.status(400);",
                  "});",
                  "",
                  "pm.test(\"Response has email validation error\", function () {",
                  "    var jsonData = pm.response.json();",
                  "    pm.expect(jsonData.success).to.be.false;",
                  "    pm.expect(jsonData.message).to.include('email');",
                  "});"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json",
                "type": "text"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"name\": \"John Doe\",\n  \"email\": \"invalid-email\",\n  \"message\": \"Test message\"\n}"
            },
            "url": {
              "raw": "{{base_url}}/api/contact",
              "host": ["{{base_url}}"],
              "path": ["api", "contact"]
            },
            "description": "Test email validation - invalid email format."
          },
          "response": []
        }
      ]
    },
    {
      "name": "Admin Endpoints",
      "item": [
        {
          "name": "Get All Contacts",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test(\"Status code is 200\", function () {",
                  "    pm.response.to.have.status(200);",
                  "});",
                  "",
                  "pm.test(\"Response has contacts array\", function () {",
                  "    var jsonData = pm.response.json();",
                  "    pm.expect(jsonData).to.have.property('contacts');",
                  "    pm.expect(jsonData.contacts).to.be.an('array');",
                  "});",
                  "",
                  "pm.test(\"Response has pagination info\", function () {",
                  "    var jsonData = pm.response.json();",
                  "    pm.expect(jsonData).to.have.property('total');",
                  "    pm.expect(jsonData).to.have.property('page');",
                  "    pm.expect(jsonData).to.have.property('totalPages');",
                  "});"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{auth_token}}",
                "type": "text"
              }
            ],
            "url": {
              "raw": "{{base_url}}/api/contact?limit=20&skip=0&sortBy=createdAt&sortOrder=-1",
              "host": ["{{base_url}}"],
              "path": ["api", "contact"],
              "query": [
                {
                  "key": "limit",
                  "value": "20"
                },
                {
                  "key": "skip",
                  "value": "0"
                },
                {
                  "key": "sortBy",
                  "value": "createdAt"
                },
                {
                  "key": "sortOrder",
                  "value": "-1"
                },
                {
                  "key": "status",
                  "value": "new",
                  "disabled": true
                },
                {
                  "key": "replied",
                  "value": "false",
                  "disabled": true
                },
                {
                  "key": "search",
                  "value": "john",
                  "disabled": true
                }
              ]
            },
            "description": "Get all contact submissions with optional filters. Requires admin authentication."
          },
          "response": []
        },
        {
          "name": "Get Contacts by Status",
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{auth_token}}",
                "type": "text"
              }
            ],
            "url": {
              "raw": "{{base_url}}/api/contact?status=new",
              "host": ["{{base_url}}"],
              "path": ["api", "contact"],
              "query": [
                {
                  "key": "status",
                  "value": "new"
                }
              ]
            },
            "description": "Get contacts filtered by status (new, in-progress, resolved, closed)."
          },
          "response": []
        },
        {
          "name": "Get Unreplied Contacts",
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{auth_token}}",
                "type": "text"
              }
            ],
            "url": {
              "raw": "{{base_url}}/api/contact?replied=false",
              "host": ["{{base_url}}"],
              "path": ["api", "contact"],
              "query": [
                {
                  "key": "replied",
                  "value": "false"
                }
              ]
            },
            "description": "Get all contacts that haven't been replied to yet."
          },
          "response": []
        },
        {
          "name": "Search Contacts",
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{auth_token}}",
                "type": "text"
              }
            ],
            "url": {
              "raw": "{{base_url}}/api/contact?search=product",
              "host": ["{{base_url}}"],
              "path": ["api", "contact"],
              "query": [
                {
                  "key": "search",
                  "value": "product"
                }
              ]
            },
            "description": "Search contacts by name, email, subject, or message content."
          },
          "response": []
        },
        {
          "name": "Get Contact Statistics",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test(\"Status code is 200\", function () {",
                  "    pm.response.to.have.status(200);",
                  "});",
                  "",
                  "pm.test(\"Response has stats object\", function () {",
                  "    var jsonData = pm.response.json();",
                  "    pm.expect(jsonData).to.have.property('stats');",
                  "    pm.expect(jsonData.stats).to.have.property('total');",
                  "    pm.expect(jsonData.stats).to.have.property('new');",
                  "    pm.expect(jsonData.stats).to.have.property('replied');",
                  "});"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{auth_token}}",
                "type": "text"
              }
            ],
            "url": {
              "raw": "{{base_url}}/api/contact/stats",
              "host": ["{{base_url}}"],
              "path": ["api", "contact", "stats"]
            },
            "description": "Get contact statistics including total, status breakdown, and reply stats."
          },
          "response": []
        },
        {
          "name": "Get Contact by ID",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test(\"Status code is 200\", function () {",
                  "    pm.response.to.have.status(200);",
                  "});",
                  "",
                  "pm.test(\"Response has contact object\", function () {",
                  "    var jsonData = pm.response.json();",
                  "    pm.expect(jsonData).to.have.property('contact');",
                  "    pm.expect(jsonData.contact).to.have.property('_id');",
                  "    pm.expect(jsonData.contact).to.have.property('name');",
                  "    pm.expect(jsonData.contact).to.have.property('email');",
                  "});"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{auth_token}}",
                "type": "text"
              }
            ],
            "url": {
              "raw": "{{base_url}}/api/contact/{{contact_id}}",
              "host": ["{{base_url}}"],
              "path": ["api", "contact", "{{contact_id}}"]
            },
            "description": "Get a specific contact by ID."
          },
          "response": []
        },
        {
          "name": "Update Contact Status",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test(\"Status code is 200\", function () {",
                  "    pm.response.to.have.status(200);",
                  "});",
                  "",
                  "pm.test(\"Status updated successfully\", function () {",
                  "    var jsonData = pm.response.json();",
                  "    pm.expect(jsonData.success).to.be.true;",
                  "    pm.expect(jsonData.contact.status).to.equal('in-progress');",
                  "});"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "PATCH",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{auth_token}}",
                "type": "text"
              },
              {
                "key": "Content-Type",
                "value": "application/json",
                "type": "text"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"status\": \"in-progress\"\n}"
            },
            "url": {
              "raw": "{{base_url}}/api/contact/{{contact_id}}/status",
              "host": ["{{base_url}}"],
              "path": ["api", "contact", "{{contact_id}}", "status"]
            },
            "description": "Update contact status. Valid values: new, in-progress, resolved, closed."
          },
          "response": []
        },
        {
          "name": "Update Status to Resolved",
          "request": {
            "method": "PATCH",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{auth_token}}",
                "type": "text"
              },
              {
                "key": "Content-Type",
                "value": "application/json",
                "type": "text"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"status\": \"resolved\"\n}"
            },
            "url": {
              "raw": "{{base_url}}/api/contact/{{contact_id}}/status",
              "host": ["{{base_url}}"],
              "path": ["api", "contact", "{{contact_id}}", "status"]
            },
            "description": "Mark contact as resolved."
          },
          "response": []
        },
        {
          "name": "Reply to Contact",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test(\"Status code is 200\", function () {",
                  "    pm.response.to.have.status(200);",
                  "});",
                  "",
                  "pm.test(\"Reply sent successfully\", function () {",
                  "    var jsonData = pm.response.json();",
                  "    pm.expect(jsonData.success).to.be.true;",
                  "    pm.expect(jsonData.contact.replied).to.be.true;",
                  "    pm.expect(jsonData.contact.replyMessage).to.exist;",
                  "});"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{auth_token}}",
                "type": "text"
              },
              {
                "key": "Content-Type",
                "value": "application/json",
                "type": "text"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"replyMessage\": \"Thank you for contacting us. We have received your inquiry about our products. Our team will review your requirements and get back to you with detailed information within 24 hours.\\n\\nBest regards,\\nCustomer Support Team\"\n}"
            },
            "url": {
              "raw": "{{base_url}}/api/contact/{{contact_id}}/reply",
              "host": ["{{base_url}}"],
              "path": ["api", "contact", "{{contact_id}}", "reply"]
            },
            "description": "Send a reply to the contact. This also marks the contact as replied and updates status to resolved."
          },
          "response": []
        },
        {
          "name": "Update Contact Notes",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test(\"Status code is 200\", function () {",
                  "    pm.response.to.have.status(200);",
                  "});",
                  "",
                  "pm.test(\"Notes updated successfully\", function () {",
                  "    var jsonData = pm.response.json();",
                  "    pm.expect(jsonData.success).to.be.true;",
                  "    pm.expect(jsonData.contact.notes).to.exist;",
                  "});"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "PATCH",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{auth_token}}",
                "type": "text"
              },
              {
                "key": "Content-Type",
                "value": "application/json",
                "type": "text"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"notes\": \"Customer interested in bulk order. Follow up with pricing details. Priority: High.\"\n}"
            },
            "url": {
              "raw": "{{base_url}}/api/contact/{{contact_id}}/notes",
              "host": ["{{base_url}}"],
              "path": ["api", "contact", "{{contact_id}}", "notes"]
            },
            "description": "Add or update internal notes for a contact. These notes are for admin use only."
          },
          "response": []
        },
        {
          "name": "Delete Contact",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test(\"Status code is 200\", function () {",
                  "    pm.response.to.have.status(200);",
                  "});",
                  "",
                  "pm.test(\"Contact deleted successfully\", function () {",
                  "    var jsonData = pm.response.json();",
                  "    pm.expect(jsonData.success).to.be.true;",
                  "    pm.expect(jsonData.message).to.include('deleted');",
                  "});"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "DELETE",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{auth_token}}",
                "type": "text"
              }
            ],
            "url": {
              "raw": "{{base_url}}/api/contact/{{contact_id}}",
              "host": ["{{base_url}}"],
              "path": ["api", "contact", "{{contact_id}}"]
            },
            "description": "Delete a contact submission. This action cannot be undone."
          },
          "response": []
        }
      ]
    },
    {
      "name": "Authentication",
      "item": [
        {
          "name": "Admin Login",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test(\"Status code is 200\", function () {",
                  "    pm.response.to.have.status(200);",
                  "});",
                  "",
                  "pm.test(\"Login successful\", function () {",
                  "    var jsonData = pm.response.json();",
                  "    pm.expect(jsonData.success).to.be.true;",
                  "    pm.expect(jsonData).to.have.property('token');",
                  "});",
                  "",
                  "// Save token for authenticated requests",
                  "if (pm.response.code === 200) {",
                  "    var jsonData = pm.response.json();",
                  "    pm.environment.set('auth_token', jsonData.token);",
                  "}"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json",
                "type": "text"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"identifier\": \"admin@example.com\",\n  \"password\": \"admin123\"\n}"
            },
            "url": {
              "raw": "{{base_url}}/api/admin/login",
              "host": ["{{base_url}}"],
              "path": ["api", "admin", "login"]
            },
            "description": "Login as admin to get authentication token for protected endpoints."
          },
          "response": []
        }
      ]
    }
  ],
  "variable": [
    {
      "key": "base_url",
      "value": "http://localhost:3000",
      "type": "string"
    },
    {
      "key": "contact_id",
      "value": "",
      "type": "string",
      "description": "Contact ID from create response"
    },
    {
      "key": "auth_token",
      "value": "",
      "type": "string",
      "description": "Admin authentication token"
    }
  ]
}
